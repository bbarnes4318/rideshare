name: Deploy to Digital Ocean

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Install sshpass
      run: sudo apt-get install -y sshpass
      
    - name: Deploy to Digital Ocean
      env:
        SSHPASS: ${{ secrets.DO_PASSWORD }}
      run: |
        # Note: We are using the script inside deploy.sh to handle the connection
        # but we need to make sure it's executable first
        chmod +x deploy.sh
        ./deploy.sh
